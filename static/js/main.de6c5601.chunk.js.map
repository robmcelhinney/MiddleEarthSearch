{"version":3,"sources":["components/Search.js","components/App.js","components/NotFound.js","index.js"],"names":["Search","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","state","query","chapters","count","currCount","books","handleChangeQuery","bind","assertThisInitialized","handleChangeBooks","handleSubmit","resetState","history","listen","location","search","params","URLSearchParams","q","get","setState","getAll","reset_and_search","event","target","value","preventDefault","query_json","edit_url","undefined","edit_title","checked","includes","name","joined","concat","array","toConsumableArray","index","indexOf","splice","react_default","a","createElement","id","className","onSubmit","type","onChange","placeholder","defaultChecked","map","item","Card_default","key","CardContent_default","paragraph","loadMore","href","replace","trim","results","MiddleEarthObj","JSON","parse","stringify","MiddleEarth","maxCount","book","length","section","para","RegExp","test","boldText","Number","push","result","_this2","onClick","e","handleLoadMore","strSubject","words","basic_words","split","s","pattern","preg_quote","str","delimiter","keyword_array","replaced","join","$m","book_param","window","pushState","document","title","constants","otherParagraphs","dangerouslySetInnerHTML","__html","side","React","Component","App","filter","components_Search","NotFound","render","react_router_dom","basename","react_router","path","component","querySelector"],"mappings":"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","file":"static/js/main.de6c5601.chunk.js","sourcesContent":["import React from 'react';\r\nimport Card from \"@material-ui/core/Card\";\r\nimport CardContent from \"@material-ui/core/CardContent\";\r\nimport MiddleEarth from \"./../MiddleEarth.json\"\r\nimport * as constants from \"../constants\";\r\n\r\nlet MAXCARDS = 10;\r\n\r\nclass Search extends React.Component {\r\n\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {\r\n\t\t\tquery: this.props.query,\r\n\t\t\tchapters: [],\r\n\t\t\tcount: null,\r\n\t\t\tcurrCount: 1,\r\n            books: this.props.books,\r\n\t\t};\r\n\t\tthis.handleChangeQuery = this.handleChangeQuery.bind(this);\r\n\t\tthis.handleChangeBooks = this.handleChangeBooks.bind(this);\r\n\t\tthis.handleSubmit = this.handleSubmit.bind(this);\r\n\t\tthis.resetState = this.resetState.bind(this);\r\n\r\n\t\tthis.props.history.listen((location) => {\r\n            const search = location.search;\r\n            const params = new URLSearchParams(search);\r\n            const q = params.get('q');\r\n            this.setState({query: q});\r\n            const books = params.getAll('books[]');\r\n            this.setState({books: books});\r\n\t\t\tthis.reset_and_search();\r\n\t\t});\r\n\t}\r\n\r\n\thandleChangeQuery(event) {\r\n        this.setState({query: event.target.value});\r\n    }\r\n\r\n\thandleSubmit(event) {\r\n        // console.log(\"handleSubmit books: \", this.state.books);\r\n\t\tthis.reset_and_search();\r\n\t\tevent.preventDefault();\r\n\t}\r\n\r\n\treset_and_search() {\r\n\t\tthis.resetState();\r\n\t\tif (this.state.query) {\r\n            this.query_json();\r\n            this.edit_url();\r\n        }\r\n\t}\r\n\r\n\tresetState() {\r\n\t\tthis.state.chapters = [];\r\n\t\tthis.state.count = 0;\r\n\t\tthis.state.currCount = 1;\r\n\t};\r\n\r\n\tcomponentDidMount() {\r\n\t\tif (this.props.query && this.props.query !== undefined) {\r\n\t\t\t// console.log(\"query not null in search\");\r\n\t\t\tthis.setState({query: this.props.query});\r\n\t\t\tthis.query_json();\r\n\t\t\tthis.edit_title();\r\n\t\t}\r\n\t}\r\n\r\n    handleChangeBooks(event) {\r\n        const checked = event.target.checked;\r\n        if (checked && !this.state.books.includes(event.target.name)) {\r\n            // add book to state\r\n            let joined = this.state.books.concat(event.target.name);\r\n            // console.log(\"add book. joined: \", joined);\r\n            this.setState({books: joined})\r\n            // this.state.books = joined;\r\n        }\r\n        else if (!checked && this.state.books.includes(event.target.name)){\r\n            // remove book from state\r\n            let array = [...this.state.books];\r\n            const index = this.state.books.indexOf(event.target.name);\r\n            array.splice(index, 1);\r\n            // console.log(\"removed [index]: \", this.state.books[index]);\r\n            // console.log(\"removed: \", array)\r\n            this.setState({books: array})\r\n        }\r\n        // console.log(\"checked books \", this.state.books);\r\n    }\r\n\r\n\trender() {\r\n        return (\r\n        \t<div id={\"search\"}>\r\n\t\t\t\t<div id=\"search_container\">\r\n\t\t\t\t\t<section id=\"section\">\r\n\t\t\t\t\t\t<section className=\"query\">Search Middle Earth</section>\r\n\t\t\t\t\t\t<form id=\"form\" onSubmit={this.handleSubmit}>\r\n\t\t\t\t\t\t\t<input type=\"text\" value={this.state.query}\r\n\t\t\t\t\t\t\t\t\tonChange={this.handleChangeQuery}\r\n\t\t\t\t\t\t\t\t\tplaceholder=\"type query here\" id=\"searchtext\"/>\r\n\t\t\t\t\t\t\t<input type=\"submit\" value='Search' id=\"searchbox\" />\r\n\t\t\t\t\t    </form>\r\n                        <section>\r\n                            <table id=\"checkboxes\">\r\n                                <tr>\r\n                                    <td><input defaultChecked={this.state.books.includes(\"TFOTR\")} type=\"checkbox\" name=\"TFOTR\" value=\"TFOTR\" className='checkbox1' onChange={this.handleChangeBooks}/>\r\n                                    <label>The Fellowship of the Ring</label></td>\r\n                                    <td><input defaultChecked={this.state.books.includes(\"TTT\")} type=\"checkbox\" name=\"TTT\" value=\"TTT\" className='checkbox1' onChange={this.handleChangeBooks} />\r\n                                    <label>The Twin Towers</label></td>\r\n                                    <td><input defaultChecked={this.state.books.includes(\"ROTK\")} type=\"checkbox\" name=\"ROTK\" value=\"ROTK\" className='checkbox1' onChange={this.handleChangeBooks} />\r\n                                    <label>The Return of the King</label></td>\r\n                                </tr>\r\n                                <tr id=\"selectboxes\">\r\n                                    <td><input type=\"checkbox\" name=\"check-all\" id=\"check-all\"/>Check All</td>\r\n                                    <td><input type=\"checkbox\" name=\"uncheck-all\" id=\"uncheck-all\"/>Uncheck All</td>\r\n                                </tr>\r\n                            </table>\r\n                        </section>\r\n\t\t\t\t\t</section>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div id=\"content\">\r\n\t\t\t\t\t<div id=\"cards\">\r\n\t\t\t\t\t\t{this.count()}\r\n\t\t\t\t\t\t{this.state.chapters.map(item => (\r\n\t\t\t\t\t\t\t<Card className={'card'} key={item['paragraph']}>\r\n\t\t\t\t\t\t\t\t<CardContent>\r\n\t\t\t\t\t\t\t\t\t<div className={\"book_chap\"}>\r\n\t\t\t\t\t\t\t\t\t\t{item['chapter_name']} - {item['book_name']}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t{Search.paragraph(item)}\r\n\t\t\t\t\t\t\t\t</CardContent>\r\n\t\t\t\t\t\t\t</Card>\r\n\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t{this.loadMore()}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div id={\"footer\"}><a href={\"https://twitter.com/RMcElhinney\"}>Rob McElhinney</a></div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n        );\r\n\t}\r\n\r\n    query_json() {\r\n\t\t// Gandalf the Grey\r\n\t\t// fly you fools\r\n\t\t// even as it fell it swung it's\r\n\t\t//saruman the white\r\n\t\t// This tale grew in the telling\r\n\t\t//tom bombadil\r\n        // console.log(\"querying json\");\r\n\t\tlet query = this.state.query.replace(/[.,\\/#!$%\\^&\\*;:{}=\\-_~()/\"/']/g, \"\");\r\n\t\tquery = query.trim();\r\n\t\t// console.log(\"query: \", query);\r\n\t\tlet results = this.state.chapters;\r\n\t\tlet MiddleEarthObj = JSON.parse(JSON.stringify(MiddleEarth));\r\n\t\tlet count = 0;\r\n\t\tlet currCount = this.state.currCount;\r\n\t\tlet maxCount = currCount + MAXCARDS;\r\n\r\n\t\t// console.log(\"books: \", this.state.books);\r\n\r\n\t\tfor(let book in MiddleEarth) {\r\n            if (this.state.books.length === 0 || this.state.books.includes(book)) {\r\n                for (let section in MiddleEarthObj[book]) {\r\n                    let para = MiddleEarthObj[book][section]['paragraph'].replace(/[.,\\/#!$%\\^&\\*;:{}=\\-_`~()/\"/']/g, \"\");\r\n                    if (new RegExp(query, 'gi').test(para)\r\n                        && !new RegExp(query).test(\"<b>\")) {\r\n                        count++;\r\n                        if (currCount === maxCount || count < currCount) {\r\n                            continue;\r\n                        }\r\n                        currCount++;\r\n                        MiddleEarthObj[book][section]['paragraph'] =\r\n                            this.boldText(MiddleEarthObj[book][section]['paragraph'], query);\r\n\r\n                        if (Number(section) > 0 &&\r\n                            MiddleEarthObj[book][section]['chapter_num']\r\n                            === MiddleEarthObj[book][Number(section) - 1][\r\n                                'chapter_num']) {\r\n                            MiddleEarthObj[book][section]['paragraphPrev'] =\r\n                                MiddleEarthObj[book][Number(section) - 1][\r\n                                    'paragraph'].replace(/(<b>|<\\/b>)/g, \"\");\r\n                        }\r\n                        if (Number(section) + 1 < MiddleEarthObj[book].length &&\r\n                            MiddleEarthObj[book][section]['chapter_num']\r\n                            === MiddleEarthObj[book][Number(section) + 1][\r\n                                'chapter_num']) {\r\n                            MiddleEarthObj[book][section]['paragraphNext'] =\r\n                                MiddleEarthObj[book][Number(section) + 1][\r\n                                    'paragraph']\r\n                        }\r\n                        results.push(MiddleEarthObj[book][section]);\r\n                    }\r\n                }\r\n            }\r\n\t\t}\r\n\t\tthis.setState({count: count});\r\n\t\tthis.setState({currCount: currCount});\r\n\t\tthis.setState({chapters: results});\r\n\t}\r\n\r\n\tcount() {\r\n\t\tif(this.state.count && this.state.chapters) {\r\n\t\t\tlet result = \"result\";\r\n\t\t\tif(this.state.count > 1) {\r\n\t\t\t\tresult += \"s\";\r\n\t\t\t}\r\n\t\t\treturn (\r\n\t\t\t\t<Card  className={\"card results_found\"} key=\"count\">\r\n\t\t\t\t\t<CardContent>\r\n\t\t\t\t\t\t<section>{this.state.count} {result} found.</section>\r\n\t\t\t\t\t</CardContent>\r\n\t\t\t\t</Card>\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\tloadMore() {\r\n\t\t// console.log(\"this.state.count: \", this.state.count);\r\n\t\t// console.log(\"this.state.currCount: \", this.state.currCount);\r\n\t\tif(this.state.count !== null && this.state.count >= this.state.currCount) {\r\n\t\t\treturn (\r\n\t\t\t\t<Card className={\"card load_more clickable\"} key=\"loadMore\"\r\n\t\t\t\t\t\tonClick={e => this.handleLoadMore(e)}>\r\n\t\t\t\t\t<CardContent>\r\n\t\t\t\t\t\t<section>Load More</section>\r\n\t\t\t\t\t</CardContent>\r\n\t\t\t\t</Card>\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n\r\n\thandleLoadMore(event) {\r\n\t\tevent.preventDefault();\r\n\t\tthis.query_json();\r\n\t}\r\n\r\n\tstatic paragraph(item) {\r\n\t\treturn (\r\n\t\t\t<div className={\"paragraphs\"}>\r\n\t\t\t\t{this.otherParagraphs(item['paragraphPrev'], \"prev\")}\r\n\t\t\t\t<div className={\"results curr\"} dangerouslySetInnerHTML={{__html: item['paragraph']}}/>\r\n\t\t\t\t{this.otherParagraphs(item['paragraphNext'], \"next\")}\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n\r\n\tstatic otherParagraphs(para, side) {\r\n\t\tif (para) {\r\n\t\t\tif (side === \"prev\") {\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<div className={\"results prev\"}>{para}</div>\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\treturn (\r\n\t\t\t\t\t<div className={\"results next\"}>{para}</div>\r\n\t\t\t\t)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tboldText(strSubject, query)\r\n\t{\r\n\t\t// I am very fond indeed of\r\n\t\tquery = this.basic_words(query);\r\n\t\tlet words = query.split(\" \");\r\n\t\tfor (let s = 0; s < words.length; s += 1)\r\n\t\t{\r\n\t\t\tlet pattern = new RegExp('\\\\b' + this.preg_quote(words[s], \"/\") + '\\\\b','gi');\r\n\t\t\t// console.log(\"pattern: \", pattern);\r\n\t\t\tstrSubject = strSubject.replace(pattern, \"<b>$&</b>\",\"\\n\");\r\n\t\t}\r\n\t\treturn strSubject;\r\n\t}\r\n\r\n\tpreg_quote(str, delimiter){\r\n\t\treturn (str + '').replace(\r\n\t\t\t\tnew RegExp('[.\\\\\\\\+*?\\\\[\\\\^\\\\]$(){}=!<>|:\\\\' +\r\n\t\t\t\t(delimiter || '') + '-]', 'g'), '\\\\$&');\r\n\t}\r\n\r\n\tbasic_words(query) {\r\n\t\tlet keyword_array = ['a','about','an','are','as','at','be', 'by','com','for','from','how','i','in','is','it','la','of','on','or', 'that','the','this','to','was','what','when','where', 'who','will','with'];\r\n\t\tquery = query.replace('/\\b(' + keyword_array.join('|') + ')\\b/i', '');\r\n\t\tlet replaced = query.replace(/\\b\\w+\\b/g, function ($m) {\r\n\t\t\tlet key = keyword_array.indexOf($m);\r\n\t\t\treturn (key !== -1)? '' : $m;\r\n\t\t});\r\n\t\treplaced = replaced.replace(/\\s+/g,' ');\r\n\t\treplaced = replaced.trim();\r\n\t\treturn replaced\r\n\t}\r\n\r\n\tedit_url() {\r\n\t    let book_param = \"\";\r\n\t    if (this.state.books && this.state.books.length > 0) {\r\n\t        book_param = this.state.books.map(a => \"&books[]=\" + a).join('');\r\n            // console.log(\"book param: \", book_param);\r\n            // console.log(\"book_param: \", book_param);\r\n        }\r\n\t\twindow.history.pushState({}, document.title, \"/MiddleEarthSearch/#/?q=\" + this.state.query + book_param);\r\n\t\tthis.edit_title();\r\n\t}\r\n\r\n\tedit_title() {\r\n\t\tdocument.title = constants.title + ' - ' + this.state.query;\r\n\t}\r\n}\r\n\r\nexport default Search;\r\n","import React from 'react';\nimport Search from './Search';\n\nclass App extends React.Component {\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            query: null,\n            books: [],\n        };\n    }\n\n    componentWillMount() {\n        const search = this.props.location.search;\n        const params = new URLSearchParams(search);\n\n        const q = params.get('q');\n        this.setState({query: q});\n        const books = params.getAll('books[]').filter(function(e){return e});\n        this.setState({books: books});\n    }\n\n    render() {\n        return (\n            <div id={\"app\"}>\n                <Search query={this.state.query} books={this.state.books}\n                        history={this.props.history}/>\n            </div>\n        );\n\t}\n}\n\nexport default App;\n","import React from 'react';\r\n\r\n\r\nconst NotFound = () => {\r\n    return (\r\n        <h2>Not Found</h2>\r\n    )\r\n}\r\n\r\n\r\nexport default NotFound;\r\n","import React from 'react';\nimport { render } from 'react-dom';\nimport { HashRouter as Router, Route, Switch } from 'react-router-dom'\n\nimport './css/style.css';\nimport App from './components/App';\nimport NotFound from './components/NotFound';\n\nconst Root = () => {\n    return(\n        <Router basename='/'>\n            <Switch>\n                <Route path='/' component={App} />\n                {/*<Route path={'/q'} component={App} />*/}\n                <Route component={NotFound} />\n            </Switch>\n        </Router>\n    )\n};\n\nrender(<Root/>, document.querySelector('#root'));\n"],"sourceRoot":""}